<!-- Merged 2025_03_31 -->
<!-- By + Copyright Greg Abbott 2024-2025. V 2025_0331-->
<html lang="en"><head><meta charset="utf-8"><link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIGlkPSJCeUdyZWdBYmJvdHQiIHg9IjAiIHk9IjAiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDIwMCAyMDAiPjxzdHlsZT4uYXtmaWxsOiNmZmY7Zm9udC1mYW1pbHk6VmVyZGFuYTt0ZXh0LWFuY2hvcjptaWRkbGV9PC9zdHlsZT48cGF0aCBmaWxsPSIjMjUyNTI1IiBkPSJNMCAwaDIwMHYyMDBIMHoiLz48dGV4dCB4PSIxMDAiIHk9IjgwIiBjbGFzcz0iYSIgZm9udC1zaXplPSI4MSI+U1Q8L3RleHQ+PHRleHQgeD0iMTAwIiB5PSIxNjEiIGNsYXNzPSJhIiBmb250LXNpemU9IjgxIj5PRzwvdGV4dD48L3N2Zz4="><style>/* c.css */
:root{color-scheme: light dark;--light:hsl(60, 25%, 95%);--dark:hsl(15, 5%, 10%);--base_x1:15px;--half_base_x1:calc(var(--base_x1) * .5);--bg:light-dark(var(--light),var(--dark));--fg:light-dark(var(--dark),var(--light));--border: 1px solid var(--fg);--line_height:130%;--border-radius:3px;}.hide {display: none !important;}* {background-color: var(--bg);color: var(--fg);font-size: 15px;margin: 0;padding: 0;box-sizing: border-box;resize: none;outline: none;}pre {white-space: pre-wrap;}[popover]{z-index: 9999999;left: 50%;padding: 1ch;top:2ch;width: 64ch;max-width: 90dvw;border-radius: 3px;transform: translateX(-50%);background-color: var(--bg);}p{margin-bottom: 1em;}#enable_js{z-index: 999;display: flex;position: fixed;top: 0;left: 0;width: 100dvw;height: 100dvh;background-color: var(--bg);color: var(--fg);align-items: center;justify-content: center;}body:has(:popover-open){#hide_popover{display: block;}}#hide_popover{position: fixed;display: none;top: 0;left: 0;margin: 0;height: 100dvh;width: 100dvw;background-color: var(--dark);opacity: .5;}html,body{width:100dvw;height:100dvh;max-width:100dvw;max-height: 100dvh;background-color: var(--bg);color: var(--fg);}body {display: flex;flex-direction: column;font-family: system-ui,sans-serif;}#header {display: flex;align-items: center;justify-content: center;text-align: center;padding: 1ch 1ch;width: 100%;}main {flex:1;display: flex;overflow-y: scroll;overflow-x: hidden;scrollbar-gutter: stable;flex-direction: column;width: 100dvw;padding: 1ch 1ch 1ch calc(1ch + 1em);#column {width: 64ch;max-width: 100%;margin: 0 auto;}label,button {display: block;}button {background-color:var(--fg);color: var(--bg);border: none;line-height: 3ch;min-height: 3ch;margin-bottom: 1ch;}button,input,textarea{width: 100%;}}footer{display: flex;justify-content: center;gap:1ch;align-items: center;padding: .5ch 0;text-align: center;button {margin-top: 2px;color: var(--fg);padding: 2px;background: transparent;border: var(--border);border-color: transparent;&:hover {border-color: var(--border);}}}footer,footer  *{font-size: 10px;}button,input,textarea{border: 1px solid var(--fg);border-radius: var(--border-radius);}input {padding: 1ch;}details {border: 1px solid var(--fg);padding: 1ch;}textarea{width: 100%;border-radius: var(--border-radius);padding: 1ch;}field{border-radius: var(--border-radius);display: flex;flex-direction: column;border: 1px solid var(--fg);overflow: hidden;padding: 0ch;margin: 0 0 1ch;label {border-bottom: 1px dashed var(--fg);padding: .5ch 1ch;line-height: 100%;}input {border: none;}}img {align-self: center;height: auto;width: auto;max-width: 100%;image-rendering: pixelated;}::-webkit-scrollbar {width: 1em;}::-webkit-scrollbar-track {background: var(--bg);}::-webkit-scrollbar-thumb {cursor: default;border: var(--border);}#pieces {display: flex;flex-direction: row;gap: 1ch;height: 32ch;margin-bottom: 1ch;& > *{border-radius: var(--border-radius);align-content: center;text-align: center;width: 50%;height: 100%;padding: 1ch;border: var(--border);display: flex;flex-direction: column;}}#default_zip_area,#custom_message_holder,#custom_image_area {flex-grow: 1;display: flex;flex-direction: column;textarea{flex-grow: 1;}}#custom_image_area{max-height: 100%;img{min-height: 1px;flex-grow: 1;flex-shrink: 1;object-fit: contain;}}#polyglot_received{margin-top: 1ch;}#save_zip_found_in_image_user_gave{margin: 1ch 0 0 0;}.dragging {background-color: aqua;}body.dragging_unaccepted_files {cursor: pointer!important;}</style><title>Stog — Put or find a zip in an image file</title></head><body><noscript><div id="enable_js">This tool requires JavaScript to run</div></noscript><header id="header"></header><main><div id="column"><p>Drop an image and or a zip onto this page (together or separately), or use the pickers below.</p><div id="pieces"><div id="image_drop_zone"><div id="default_image_area"><button id="trigger_image_input_picker" title="Or find and extract a zip file from an existing polyglot file">Choose a PNG or JPG</button> Or use this image:<br><input hidden="" type="file" id="image_picker" accept="image/png, image/jpeg"><img id="preview_default_img"></div><div id="custom_image_area" class="hide"><button id="remove_chosen_image">Remove Image</button><img id="preview_user_picked_img"><div id="polyglot_received" class="hide"><button id="save_zip_found_in_image_user_gave" title="Zip file extracted from polyglot file given"> Save zip found in image</button></div></div></div><div id="zip_drop_zone"><div id="default_zip_area"><button id="trigger_zip_picker">Choose a .zip</button><input hidden="" type="file" id="zip_picker" accept=".zip"><div id="custom_message_holder"> Or zip this text: <textarea id="custom_text_message">Hello</textarea><br>In a file named: <input type="text" id="custom_text_file_name" value="Note"></div></div><div id="custom_zip_area" class="hide"><button id="remove_chosen_zip">Remove Zip</button> Chosen zip:<br><div id="chosen_zip_name"></div></div></div></div><field><label for="output_file_name">Combine the image and zip into a file named:</label><input type="text" id="output_file_name" value="Polyglot" required=""></field><button id="save_button">Save</button><p><b>Appearance</b><br> The produced polyglot file contains both the image and the zip. It hides or shows either based on whether the file name ends with the extension ".<b id="current_img_ext" title="the extension type of the provided image">png</b>" or "<b>.zip</b>".</p><p><b>Unarchiving</b><br>Some applications can unarchive the zip inside a given polyglot file directly. Others require extracting the zip first. </p><p><b>Extract a zip from a polyglot file</b><br> If this tool receives an image that holds a zip, it extracts the zip and image, to save either separately.</p></div></main><div id="hide_popover"></div><div popover="" id="popover_license"><p>By and Copyright © 2024-2025 <a href="https://gregabbott.pages.dev/">Greg Abbott</a>. All rights reserved.<br> (Site, tool, documentation etc.)</p><p>NO WARRANTY<br> THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. </p></div><footer><button popovertarget="popover_license">License | By + ©</button><a href="https://gregabbott.pages.dev/">Greg Abbott</a> 2025 | <a href="changelog.html">Log</a> | <a href="https://buymeacoffee.com/gregabbott">Buy Me A Coffee</a> | <a href="https://ko-fi.com/gregabbott">KoFi</a></footer><script>/* 
zip.js
j.js
 */
var new_zip=({name:e="",progress_text:t=!1,progress_bar:n=!1})=>{var a=e=>e.trim().replace(/[^\x00-\x7F]/g,"-"),i={status_text_el:t,status_bar_el:n,used_names:{},zip:{unzipped_name:a(e),pre_save_list:[],file:[]}},r=e=>new Uint8Array(e.split(" ").map((e=>parseInt(e,16)))),o=e=>{let t=[];for(let n=0;n<e.length;n+=2)t[n]=e[n]+""+e[n+1];return t.filter((e=>e)).reverse().join(" ")},l=(e,t)=>e.toString(2).padStart(t,"0"),s=e=>parseInt(e.slice(8),2).toString(16).padStart(2,"0")+" "+parseInt(e.slice(0,8),2).toString(16).padStart(2,"0"),_=e=>{for(var t=atob(e.split(",")[1]),n=new ArrayBuffer(t.length),a=new Uint8Array(n),i=0;i<t.length;i++)a[i]=t.charCodeAt(i);return[...a]},c=e=>0==e.length||e.endsWith("/")?e:e+"/",d=({path:e,name:t,ext:n,n:a=""})=>{var r=t+(""==a?"":" ("+a+")");return i.used_names[e+r+n]?d({path:e,name:t,ext:n,n:""==a?1:a++}):(i.used_names[e+r+n]=1,r)},g=({kind:e})=>({path:t="",name:n="",ext:r="",content:o="",date:l=new Date})=>{var s,g,f;t=c(a(t)),n=a(n.replaceAll("/",":")),r=0==(s=a(r)).length||s.startsWith(".")?s:"."+s,n.length>0&&(n=d({path:t,name:n,ext:r})),i.zip.pre_save_list.push({uintData:"image"==e?_(o):(g=o,[...new Uint8Array((f=g,Array.from((new TextEncoder).encode(f))))]),date:new Date(l),fileUrl:""+t+n+r})},f=e=>new Date(e).toISOString().slice(14,19);function p(){let e=0,t="",n=0,_="00 00 00 00";var d,g,p=!1;(i.status_text_el||i.status_bar_el)&&(d=i.zip.pre_save_list.length,g={began:Date.now(),n_done:0},p=()=>{g.n_done++,g.ms_gone=Date.now()-g.began,g.p_done=g.n_done>=d?100:Math.floor(g.n_done/(d/100)),g.n_todo=d-g.n_done,g.avg=g.ms_gone/g.n_done,i.status_text_el&&(i.status_text_el.innerText=`Done: ${g.n_done} of ${d} (${g.p_done}%) in ${f(g.ms_gone)}. Left: ${g.n_todo} (~${f(g.n_todo*g.avg)}). Average: ${f(g.avg)} per item.`),i.status_bar_el&&(i.status_bar_el.style.width=Math.min(100,g.p_done)+"%")});var u=c(a(i.zip.unzipped_name));i.zip.pre_save_list.forEach((a=>{var c,d=u+a.fileUrl,g=o(parseInt(a.uintData.length).toString(16).padStart(8,"0")),f=(c=d,[...(new TextEncoder).encode(c)].map((e=>e.toString(16).padStart(2,"0")))).join(" "),m=o(d.length.toString(16).padStart(4,"0")),A=`${(e=>{var t=new Date(e),n=l,a=n(t.getFullYear()-1980,7),i=n(t.getMonth()+1,4),r=n(t.getDate(),5),o=n(t.getHours(),5),_=n(t.getMinutes(),6),c=n(Math.round(t.getSeconds()/2),5);return s(""+o+_+c)+" "+s(""+a+i+r)})(a.date)} ${(e=>{for(var t,n=[],a=0;a<256;a++){t=a;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;n[a]=t}for(var r=-1,l=0;l<e.length;l++)r=r>>>8^n[255&(r^e[l])];return o((~r>>>0).toString(16).padStart(8,"0"))})(a.uintData)} ${g} ${g} ${m} `;fileHeaderBuffer=r(`50 4B 03 04 14 00 00 00 00 00 ${A}00 00 ${f}`),n+=fileHeaderBuffer.length+a.uintData.length,t+="50 4B 01 02 14 00 14 00 00 00 00 00 "+A+"00 00 00 00 00 00 01 00 20 00 00 00 "+`${_} ${f} `,_=o(n.toString(16).padStart(8,"0")),i.zip.file.push(fileHeaderBuffer,new Uint8Array(a.uintData)),e++,p&&p()})),t=t.trim();let m=o(e.toString(16).padStart(4,"0")),A=`50 4b 05 06 00 00 00 00 ${m} ${m} ${o(t.split(" ").length.toString(16).padStart(8,"0"))} ${o(n.toString(16).padStart(8,"0"))} 00 00`;return i.zip.file.push(r(t),r(A)),[...i.zip.file]}return i.zip.add_text_file=g({kind:"text"}),i.zip.add_image_file=g({kind:"image"}),i.zip.add_folder=g({kind:"folder"}),i.zip.get=p,i.zip.save=function(e){let t=p(),n=document.createElement("a");n.href=URL.createObjectURL(new Blob(t,{type:"application/octet-stream"})),n.download=e+".zip",n.click(),n.remove()},i.zip};document.addEventListener("DOMContentLoaded",(()=>{const e={};["header","default_image_area","trigger_image_input_picker","image_picker","preview_default_img","custom_image_area","remove_chosen_image","preview_user_picked_img","polyglot_received","save_zip_found_in_image_user_gave","default_zip_area","trigger_zip_picker","zip_picker","custom_text_file_name","custom_text_message","custom_zip_area","remove_chosen_zip","chosen_zip_name","output_file_name","save_button","current_img_ext"].forEach((t=>{var n;e[t]=(n=t,document.getElementById(n))})),e.trigger_zip_picker.onclick=()=>e.zip_picker.click(),e.trigger_image_input_picker.onclick=()=>e.image_picker.click();let[t,n]=document.title.split("—");e.header.innerHTML=`<span><b>${t}</b> ${n}</span>`;let a=[...document.getElementsByClassName("output_name_sync")];function i(){a.forEach((t=>t.innerText=e.output_file_name.value))}e.output_file_name.onkeyup=i,i();let r=e.save_button.textContent,o={smiley_face:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAMElEQVR42mP4jwYYcAgwAAGSAAMyiayNAYYRCIPCJQABOFVAMZjAsBbdYdidTtC3ADUQ1Sug+UV6AAAAAElFTkSuQmCC",smiley_transparent_16:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAACVBMVEVHcEz///8AAADmzmMiAAAAAXRSTlMAQObYZgAAAENJREFUeJxNjLENgDAMwCw2DsnCP4kSJpb8wRM5AYkzq7aq1MWTbbh+OMpeTtUHUXUk0qlI21G2kGHI/fmURzYGfdUAZ4AV+rx9Sv0AAAAASUVORK5CYII="},l=o.smiley_transparent_16;e.preview_default_img.src=l;let s={};function _(e){e.classList.remove("hide")}function c(e){e.classList.add("hide")}function d(){e.image_picker.value="",s.given_image_file=null,c(e.custom_image_area),_(e.default_image_area),e.current_img_ext.innerText="png"}s.default_img_as_array_buffer=null,s.given_image_file=null,function(t){function n(e,t,n){e.addEventListener(t,n)}function a(e){e.preventDefault(),e.stopPropagation()}function i(){t.classList.remove("dragging","dragging_unaccepted_files")}let r=!1;n(window,"dragover",a),n(window,"drop",(function(t){a(t),i();let n=[...t.dataTransfer.files],r=n.find((e=>e.type.startsWith("image/"))),o=n.find((e=>"application/zip"==e.type));if(r){let t=new DataTransfer;t.items.add(r),e.image_picker.files=t.files,e.image_picker.dispatchEvent(new Event("change"))}if(o){let t=new DataTransfer;t.items.add(o),e.zip_picker.files=t.files,e.zip_picker.dispatchEvent(new Event("change"))}})),n(window,"dragenter",(function(e){r=[...e.dataTransfer.items].some((e=>"file"==e.kind&&(e.type.startsWith("image/")||"application/zip"==e.type))),e.dataTransfer.dropEffect=r?"copy":"none",t.classList.add("dragging_over"),r||t.classList.add("dragging_unaccepted_files")})),n(window,"dragleave",i)}(document.body),e.remove_chosen_image.onclick=d,e.save_button.addEventListener("click",(async function(){try{let n,a,i;if(e.zip_picker.files[0])n=await f(e.zip_picker.files[0]);else{var t;t=new_zip({});let a=e.custom_text_file_name.value.trim();0===a.length&&(a="Message"),t.add_text_file({name:a,ext:"md",content:e.custom_text_message.value,date:"2001-01-01T01:00:00"}),n=function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new ArrayBuffer(t),a=new Uint8Array(n);let i=0;for(const t of e)a.set(t,i),i+=t.length;return n}(t.get())}e.save_button.disabled=!0,e.save_button.textContent="Processing...",s.given_image_file?a=s.given_image_file:(null===s.default_img_as_array_buffer&&(s.default_img_as_array_buffer=function(e){const t=window.atob(e),n=t.length,a=new Uint8Array(n);let i=0;for(;i<n;i++)a[i]=t.charCodeAt(i);return a.buffer}(l.split(",")[1])),a=s.default_img_as_array_buffer),i=new Uint8Array(a);const r=function(e){if([137,80,78,71,13,10,26,10].every(((t,n)=>e[n]===t)))return"PNG";if(255===e[0]&&216===e[1]&&255===e[2])return"JPEG";throw Error("Unsupported image format. Please use PNG or JPEG.")}(i),o=await async function(e,t,n){const a=new Uint8Array(e),i=new Uint8Array(t);if(![80,75,3,4].every(((e,t)=>i[t]===e)))throw Error("Invalid ZIP file format");return"PNG"===n?async function(e,t){if(![137,80,78,71,13,10,26,10].every(((t,n)=>e[n]===t)))throw Error("Invalid PNG file format");let n=8,a=!1;for(;n<e.length-12;){const t=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3];if("IEND"===String.fromCharCode(e[n+4],e[n+5],e[n+6],e[n+7])){n+=12+t,a=!0;break}n+=12+t}if(!a){console.log("Adding IEND chunk");const t=new Uint8Array([0,0,0,0,73,69,78,68,174,66,96,130]),a=new Uint8Array(n+t.length);a.set(e.slice(0,n)),a.set(t,n),n+=t.length}let i=-1;for(let e=t.length-22;e>=0;e--)if(80===t[e]&&75===t[e+1]&&5===t[e+2]&&6===t[e+3]){i=e;break}if(-1===i)throw Error("Invalid ZIP structure: End of central directory not found");const r=new Uint8Array(n+t.length);r.set(e.slice(0,n)),r.set(t,n);const o=new DataView(r.buffer);let l=n,s=n;for(;s<r.length-4;s++)if(80===r[s]&&75===r[s+1]&&1===r[s+2]&&2===r[s+3]){const e=o.getUint32(s+42,!0);o.setUint32(s+42,e+l,!0)}if(-1!==i){const e=o.getUint32(n+i+16,!0);o.setUint32(n+i+16,e+l,!0)}return r}(a,i):async function(e,t){let n=-1;for(let t=e.length-2;t>=0;t--)if(255===e[t]&&217===e[t+1]){n=t+2;break}if(-1===n)throw Error("Invalid JPEG: EOF marker not found");const a=new Uint8Array(n+t.length);a.set(e.slice(0,n)),a.set(t,n);const i=new DataView(a.buffer);let r=n;for(let e=r;e<a.length-4;e++)if(80===a[e]&&75===a[e+1]&&1===a[e+2]&&2===a[e+3]){const t=i.getUint32(e+42,!0);i.setUint32(e+42,t+r,!0)}for(let e=a.length-22;e>=0;e--)if(80===a[e]&&75===a[e+1]&&5===a[e+2]&&6===a[e+3]){const t=i.getUint32(e+16,!0);i.setUint32(e+16,t+r,!0);break}return a}(a,i)}(a,n,r),_="PNG"===r?".png":".jpg",c=(e.output_file_name.value||"output")+_;await p(o,c)}catch(e){console.error("Error:",e),alert("An error occurred while processing the files.\n(See the console)")}finally{e.save_button.disabled=!1,e.save_button.textContent=r}}));function g(){e.zip_picker.value="",c(e.custom_zip_area),_(e.default_zip_area)}function f(e){return new Promise(((t,n)=>{const a=new FileReader;a.onload=()=>t(a.result),a.onerror=()=>n(Error("Failed to read file")),a.readAsArrayBuffer(e)}))}function p(e,t){return new Promise(((n,a)=>{try{let a=e;e instanceof Blob||(a=new Blob([e],{type:"application/octet-stream"}));const i=URL.createObjectURL(a),r=document.createElement("a");r.href=i,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout((()=>{URL.revokeObjectURL(i),n()}),100)}catch(e){a(Error("Failed to save file: "+e.message))}}))}function u(e,t=0){for(let n=t;n<e.length-3;n++)if(80===e[n]&&75===e[n+1]&&3===e[n+2]&&4===e[n+3])return n;return-1}e.zip_picker.addEventListener("change",(()=>{let t=e.zip_picker.files[0];t?(e.chosen_zip_name.innerText=t.name,_(e.custom_zip_area),c(e.default_zip_area)):g()})),e.remove_chosen_zip.onclick=g,e.image_picker.addEventListener("change",(async()=>{let t=e.image_picker.files[0];if(c(e.polyglot_received),!t)return void d();s.given_image_file=await f(t);let n=await async function(e){const t=new Uint8Array(e);return 255===t[0]&&216===t[1]?await async function(e){const t=u(e);return-1!==t&&{zip_data:e.slice(t),img_data:e.slice(0,t)}}(t):137===t[0]&&80===t[1]&&await async function(e){let t=8;for(;t<e.length-12;){const n=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];if("IEND"===String.fromCharCode(...e.slice(t+4,t+8)))break;t+=12+n}const n=u(e,t);return-1!==n&&{zip_data:e.slice(n),img_data:e.slice(0,n)}}(t)}(s.given_image_file);n?(!function(t,n){let a=new Blob([t],{type:"application/zip"});_(e.polyglot_received),e.save_zip_found_in_image_user_gave.onclick=()=>{p(a,`ZipFoundInImage "${n}".zip`)}}(n.zip_data,t.name),s.given_image_file=n.img_data):console.log("found no zip already within image user gave"),e.preview_user_picked_img.src=(e=>{const t=new Blob([e]);return URL.createObjectURL(t)})(s.given_image_file),e.preview_user_picked_img.title=t.name+(n?"\nImage extracted from the polyglot file given":""),e.current_img_ext.innerText=t.type.toLowerCase().replace("image/","").replace("jpeg","jpg"),c(e.default_image_area),_(e.custom_image_area)}))}));</script></body></html>